<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xml:base="https://synshop.org"  xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:wfw="http://wellformedweb.org/CommentAPI/">
<channel>
 <title>Nathan Bryant&#039;s blog</title>
 <link>https://synshop.org/blog/nathan-bryant</link>
 <description></description>
 <language>en</language>
<item>
 <title>Vending Machine Electronics</title>
 <link>https://synshop.org/blog/nathan-bryant/vending-machine-electronics</link>
 <description>&lt;div class=&quot;field field-name-body field-type-text-with-summary field-label-hidden&quot;&gt;&lt;div class=&quot;field-items&quot;&gt;&lt;div class=&quot;field-item even&quot; property=&quot;content:encoded&quot;&gt;&lt;p&gt;Some of you may remember the vending machine Dataman and I picked during the &lt;a href=&quot;https://groups.google.com/d/topic/synshop/5ZE0uwHUoi0/discussion&quot; target=&quot;_self&quot; rel=&quot;nofollow&quot;&gt;summer&lt;/a&gt;. It&#039;s an old cigarette vending machine that we want to modify to sell electronics kits and other do-dads. We&#039;ve decided that the best way to do this is to turn the vending maching into the fulfillment system for a web store.&lt;/p&gt;&lt;p&gt;The first step to doing this is to turn the 20+ year old electronics into something that can be connected to the internet. The old controller is pretty rudimentary (although very clever for the time). After poking it for a bit at one of our Hackup meetings, we figured out that pushing the each of the buttons directly closes the circuit that powers one of the motors for a brief period of time. The controller board simply enables turns the buttons on. We need to have a bit more control over the system, so we decided to ditch the existing controller board.&lt;/p&gt;&lt;p&gt;The motors in the machine are all 24 volt AC motors. Built into the drive system are switches (one for each motor) that turn on when the motors are preturbed from the home position. These switches are hooked up to drive the motor itself. What this means is that the motor only needs to be turned on from an external source for less than a second, and after the motor is perturbed from the home position, it will drive itself until it is back in the home position (and the internal switch turns itself back off).&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://lh3.googleusercontent.com/-vMPW4ySd5Fo/ULQlkFpAGMI/AAAAAAAAEcw/Kbjmal716u4/s1148/P1070058.JPG&quot; alt=&quot;&quot; width=&quot;574&quot; height=&quot;430&quot; /&gt;&lt;/p&gt;&lt;p&gt;To control the 24V AC motors, we need a way to switch the higher voltage from a lower voltage. TRIACs would work for this, but they would require a custom PCB because they are a bit uncommon. Relay boards are fairly easy to find and inexpensive. The down side is that relays are less reliable than solid state components, but the price and ease of sourcing seemes to be a worthwhile tradeoff. I found &lt;a href=&quot;http://dx.com/p/8-channel-5v-solid-state-relay-module-board-red-blue-121337&quot; target=&quot;_self&quot; rel=&quot;nofollow&quot;&gt;these&lt;/a&gt; on DealExtreme to do the job. They have 2mm pitch connectors to tonnect to the control lines and screw terminals for the power connections. We need one relay for each of the channels (motors) and there are 30 channels in the machine, so I bought 4 of them. The traces are tinned, but not soldermasked, which is actually very helpful for this application. Because each of the motors is driven from a single 24V AC source, I soldered a jumper wire across common pins on each of the relays so the 24V line needs to be hooked up only once per board. &lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://lh4.googleusercontent.com/-G2icyWu6sxg/ULQlkriDIQI/AAAAAAAAEc4/NVjBBorhvgA/s1148/P1070059.JPG&quot; alt=&quot;&quot; width=&quot;574&quot; height=&quot;430&quot; /&gt;&lt;/p&gt;&lt;p&gt;To turn on the relays, we again have 30 channels to drive, this time at 5V and very low current. Microcontrollers are capacble of controlling this sort of load, but the non-mega arduinos doen&#039;t have enough availible channels to do this. Arduino&#039;s are also a bit limited in their web interfacing capabilities (I can&#039;t imagine performing web key encryption on one), so we will  need a bit more horsepower in the vending machine anyways. Raspberry Pi&#039;s are capable of communicating with perepherals using I2C. I found &lt;a href=&quot;https://www.sparkfun.com/products/8130&quot; target=&quot;_self&quot; rel=&quot;nofollow&quot;&gt;these&lt;/a&gt; I2C expander breakout boards at Sparkfun that are relatively inexpensive and are perfect for this sort of thing. I2C is a digital communication protocol and in this case, the Raspberry Pi sends an address over three wires to the chip on the breakout board and the chip turnes one of the 16 pins on the board on or off. We&#039;ll expand on this later.&lt;/p&gt;&lt;p&gt;The relays on the relay board I picked are 12v relays, and although they can be controled with 5v on the control pins, they require 12v DC to trigger the magnetic switch inside. The boards have opto-isolators and transistors inside that handle converting the 5v microcontroller signal into a 12v signal at enough current to drive the magnetic switch. But they we still need separate 12v and 5v DC supplies. Once again, deal extreme sells both of these things (110v AC to &lt;a href=&quot;http://dx.com/p/5v-2a-regulated-switching-power-supply-110-220v-94518&quot; rel=&quot;nofollow&quot;&gt;5v DC&lt;/a&gt; and &lt;a href=&quot;http://dx.com/p/12v-1a-regulated-switching-power-supply-110-220v-94519&quot; target=&quot;_self&quot; rel=&quot;nofollow&quot;&gt;12v DC&lt;/a&gt;). I might use a Murata 5V DC converter with the 12v supplier instead of the 5v supply.&lt;/p&gt;&lt;p&gt;To keep all of this stuff organized, I drafted out something is skechup to cut out on a laser cutter. I still have to add the raspberry pi, the power supplies and a few odds and ends on there, but it&#039;s getting there.&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://lh4.googleusercontent.com/-H0-kvoz8iBk/ULQ2QEVxSNI/AAAAAAAAEdE/ZbatsfDkjK0/s1542/Relay+Board+Color.png&quot; alt=&quot;&quot; width=&quot;771&quot; height=&quot;367&quot; /&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</description>
 <pubDate>Tue, 27 Nov 2012 15:57:59 +0000</pubDate>
 <dc:creator>Nathan Bryant</dc:creator>
 <guid isPermaLink="false">105 at https://synshop.org</guid>
 <comments>https://synshop.org/blog/nathan-bryant/vending-machine-electronics#comments</comments>
 <wfw:commentRss>https://synshop.org/crss/node/105</wfw:commentRss>
</item>
</channel>
</rss>
